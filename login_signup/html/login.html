<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <!-- Responsive viewport meta tag-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/login.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <meta name="google-signin-client_id"
        content="704955964578-h12ktncaj45noqmmb3q3hu9vrtkhh5ol.apps.googleusercontent.com">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
    <script src="https://apis.google.com/js/api:client.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="js/google.js"></script>
    <script src="js/normal.js"></script>

    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v11.0"
        nonce="BJxM7W7J"></script>
    <title>login/signup</title>
</head>

<body>
    <header>
        <div>
            <a class="bar-link" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#loginModal">Log In/Sign
                Up
            </a>
        </div>
    </header>
    <!-- LoginModal -->
    <div style="margin-top: 80px;" class="modal fade" id="loginModal" data-bs-backdrop="static" data-bs-keyboard="false"
        tabindex="-1" aria-labelledby="signUpModalLabel" aria-hidden="true">
        <div class="modal-dialog ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="upper_bar_LS">Log In</div>
                <div class="modal-body">
                    <div name="siteDiv" style="display: block;">
                        <!-- google -->
                        <div id="gSignInWrapper">
                            <div id="loginGoogleBtn" class="btn-group siteLoginBtn">
                                <div class="btn btn-outline-secondary center">
                                    <span class="google mx-auto"></span>
                                    <span class="buttonText mx-auto googleText">Continue with Google</span>
                                </div>
                            </div>
                        </div>
                        <div id="name"></div>

                        <script>
                            startApp();
                        </script>
                        <!-- facebook -->
                        <div>
                            <div class="btn-group siteLoginBtn" onclick="facebook_login(true)">
                                <div class="btn btn-outline-secondary center">
                                    <span class="facebook mx-auto"></span>
                                    <span class="buttonText mx-auto facebookText">Continue with Facebook</span>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin:5px; font-weight:bold">or</div>
                    </div>

                    <form id="logInForm" class="mb-3 needs-validation" novalidate>
                        <input type="email" name="email" class="form-control mb-2 bold" placeholder="email" required>
                        <input type="password" name="password" class="form-control mb-2 bold" placeholder="password"
                            required>
                        <button type="submit" class="btn btn-dark w-100 mb-2">Log in</button>
                    </form>
                    <div style="text-align: center; margin:5px; font-weight:bold">
                        <span>Not have an account yet?</span>
                        <span><a href="#" onclick="changeType()">Sign Up</a></span>
                    </div>
                </div>
                <div>
                </div>
            </div>
        </div>
    </div>
    <!-- signUpModal -->
    <div style="margin-top: 80px; " class="modal fade" id="signUpModal" data-bs-backdrop="static"
        data-bs-keyboard="false" tabindex="-1" aria-labelledby="signUpModalLabel" aria-hidden="true">
        <div class="modal-dialog ">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                    <input type="radio" class="btn-check" name="btnradio" id="customerBtn" autocomplete="off" checked>
                    <label class="btn btn-outline-secondary toggle-btn toggle" for="customerBtn">Sign Up</label>
                </div> -->
                <div class="upper_bar_LS">Sign Up</div>
                <div class="modal-body">
                    <div name="siteDiv" style="display: block;">
                        <!-- google -->
                        <div id="gSignInWrapper">
                            <div id="signUpGoogleBtn" class="btn-group siteLoginBtn">
                                <div class="btn btn-outline-secondary center">
                                    <span class="google mx-auto"></span>
                                    <span class="buttonText mx-auto googleText">Continue with Google</span>
                                </div>
                            </div>
                        </div>
                        <div id="name"></div>

                        <script>
                            startApp();
                        </script>

                        <!-- facebook -->
                        <div>
                            <div class="btn-group siteLoginBtn" onclick="facebook_login(false)">
                                <div class="btn btn-outline-secondary center">
                                    <span class="facebook mx-auto"></span>
                                    <span class="buttonText mx-auto facebookText">Continue with Facebook</span>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin:5px; font-weight:bold">or</div>
                    </div>

                    <div style="text-align: center; margin:5px; font-weight:bold">
                        <span>Already have an account?</span>
                        <span><a href="#" onclick="changeType()">Log in</a></span>
                    </div>
                </div>
                <div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    
    var isLogin = true;
    changeType = () => {
        isLogin = !isLogin;
        if (isLogin) {
            $('#signUpModal').modal('hide');
            $('#loginModal').modal('show');
        } else {
            $('#signUpModal').modal('show');
            $('#loginModal').modal('hide');
        }
    }
    $(document).ready(function () {
        //    $('#loginModal').modal('show');
        $(".toggle-btn").on('click', (event) => {
            const forText = event.target.getAttribute('for').toString();
            console.log(event.target.getAttribute('for'), $('div[name="storeDiv"]').css("display"))
            if (forText == "storeBtn" || forText == "loginStoreBtn") {
                $('div[name="storeDiv"]').css("display", "block");
                $('div[name="siteDiv"]').css("display", "none");
            } else {
                $('div[name="storeDiv"]').css("display", "none");
                $('div[name="siteDiv"]').css("display", "block");
                // $('#ppp').css("display", "block");         
            }
        })
    });

    window.fbAsyncInit = function () {
        FB.init({
            appId: '172697884853316',
            cookie: true,
            status: true,
            xfbml: true,
            version: 'v11.0'
        });

        FB.AppEvents.logPageView();

    };
</script>
<script src="js/facebook.js"></script>
<script>
    $('.needs-validation').submit(function (event) {
        event.preventDefault();
        if (event.target.id == "logInForm") {
            var data = {
                email: $(event.target).children("input[name='email']").val().toString(),
                password: $(event.target).children("input[name='password']").val().toString(),
                kind: "admin"
            }
            console.log("login")
            normalLogin(data);
        } else {
            var data = {
                email: $(event.target).children("input[name='email']").val().toString(),
                password: $(event.target).children("input[name='password']").val().toString(),
                name: $(event.target).children("input[name='name']").val().toString(),
                kind: 'normal'
            }
            if ($('div[name="storeDiv"]').css("display") == "none") {
                data.address = $('div[name="storeDiv"]').children("input[name='name']").val().toString();
                data.tel = $('div[name="storeDiv"]').children("input[name='tel']").val().toString();
                data.store = $('div[name="storeDiv"]').children("select[name='store']").val().toString();
                data.kind = "store"

            } else if ($('div[name="siteDiv"]').css("display") == "none") {
                data.kind = "store"
            }
            normalSignUp(data)
        }
    });
    (function () {
        'use strict'

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll('.needs-validation')

        // Loop over them and prevent submission
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    } else {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
    })()
</script>

</html>